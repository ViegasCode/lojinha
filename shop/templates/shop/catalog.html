<!doctype html>
<html lang="pt-br">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Catálogo</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/catalog.css' %}">
</head>
<body>
    {% load pricing %}
    <h1>Catálogo</h1>

    <div class="toolbar">
        </div>

    <div class="grid">
        {% for p in products %}
        <a href="{% url 'product_detail' p.slug %}" class="card-link">
            <div class="card">
              <div class = "card-image-countainer">
                {% if p.image_url %}<img src="{{ p.image_url }}" alt="{{ p.title }}" />{% endif %}
              </div>
                <div class="card-content">
                    <div style="display:flex;align-items:center;gap:8px;justify-content:space-between">
                        <h3 style="margin:8px 0">{{ p.title }}</h3>
                        <div style="display:flex;gap:6px;align-items:center">
                            {% if p.featured %}<span class="badge">★ Destaque</span>{% endif %}
                            {% if p.stock == 0 %}
                                <span class="badge out">Sem estoque</span>
                            {% elif p.stock <= 3 %}
                                <span class="badge warn">Acaba logo</span>
                            {% endif %}
                        </div>
                    </div>
                    {% if p.category %}<div class="muted">{{ p.category.name }}</div>{% endif %}
                    <div class="price">{{ p.price_cents|money }}</div>
                    {% best_installment p.price_cents as inst %}
                    {% if inst %}
                        <div class="muted">Em até {{ inst.n }}x de {{ inst.per_cents|money }} sem juros</div>
                    {% endif %}
                </div>
            </div>
        </a>
        {% empty %}
        <p>Nenhum produto encontrado.</p>
        {% endfor %}
    </div>

    </body>
</html>